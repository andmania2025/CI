---
description: Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æŒ‡é‡ã¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæœ€é©åŒ–ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
globs:
  - "apps/web/**/*"
alwaysApply: false
---

# Web ã‚¢ãƒ—ãƒª ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æŒ‡é‡

## ç¾çŠ¶åˆ†æ

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€  (apps/web/src/)

```
apps/web/src/
â”œâ”€â”€ app/                       # Next.js App Router
â”‚   â”œâ”€â”€ (auth)/               # èªè¨¼é–¢é€£ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ (property)/           # ç‰©ä»¶é–¢é€£ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ (protected)/          # èªè¨¼å¿…é ˆãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ (public)/             # ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ api/                  # APIãƒ«ãƒ¼ãƒˆ
â”‚   â””â”€â”€ auth/                 # èªè¨¼ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯
â”œâ”€â”€ components/               # UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ auth/                 # èªè¨¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ cards/                # ã‚«ãƒ¼ãƒ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ common/               # å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ company/              # ä¼šç¤¾é–¢é€£
â”‚   â”œâ”€â”€ forms/                # ãƒ•ã‚©ãƒ¼ãƒ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ icons/                # ã‚¢ã‚¤ã‚³ãƒ³
â”‚   â”œâ”€â”€ layout/               # ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”‚   â”œâ”€â”€ marketing/            # ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°
â”‚   â”œâ”€â”€ navigation/           # ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”œâ”€â”€ search/               # æ¤œç´¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â””â”€â”€ ui/                   # åŸºæœ¬UI
â”œâ”€â”€ data/                     # é™çš„ãƒ‡ãƒ¼ã‚¿
â”œâ”€â”€ features/                 # æ©Ÿèƒ½åˆ¥ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”œâ”€â”€ hooks/                    # ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
â”œâ”€â”€ lib/                      # ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ»ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”œâ”€â”€ schemas/                  # Zodã‚¹ã‚­ãƒ¼ãƒ
â”œâ”€â”€ stores/                   # Zustandã‚¹ãƒˆã‚¢
â””â”€â”€ types/                    # å‹å®šç¾©
```

## ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å„ªå…ˆé †ä½

### ğŸ”´ é«˜å„ªå…ˆåº¦ (Phase 1)

#### 1. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®æ•´ç†ãƒ»çµ±åˆ

**å•é¡Œç‚¹:**
- `components/` ç›´ä¸‹ã«ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹ (`FavoriteButton.tsx`, `PropertySearchDropdown.tsx` ãªã©)
- `components/ui/` ã¨ `components/common/` ã®å½¹å‰²ãŒä¸æ˜ç¢º

**ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:**
```
# ä¿®æ­£å‰
components/
â”œâ”€â”€ FavoriteButton.tsx        # ç›´ä¸‹ã«é…ç½®
â”œâ”€â”€ PropertySearchDropdown.tsx
â”œâ”€â”€ RentalSearchDropdown.tsx
â”œâ”€â”€ ui/                       # åŸºæœ¬UI
â””â”€â”€ common/                   # å…±é€š?

# ä¿®æ­£å¾Œ
components/
â”œâ”€â”€ ui/                       # åŸºæœ¬UI (Button, Input, Card ãªã©)
â”œâ”€â”€ shared/                   # ã‚¢ãƒ—ãƒªå…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ FavoriteButton.tsx
â”‚   â””â”€â”€ Dropdown/
â”œâ”€â”€ property/                 # ç‰©ä»¶é–¢é€£ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ PropertySearchDropdown.tsx
â”‚   â”œâ”€â”€ RentalSearchDropdown.tsx
â”‚   â””â”€â”€ PropertyCard.tsx
â””â”€â”€ [feature]/                # æ©Ÿèƒ½åˆ¥ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
```

#### 2. é‡è¤‡ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®çµ±åˆ

**ãƒã‚§ãƒƒã‚¯é …ç›®:**
- [ ] `PropertySearchDropdown.tsx` ã¨ `RentalSearchDropdown.tsx` ã®å…±é€šåŒ–å¯èƒ½æ€§ã‚’ç¢ºèª
- [ ] `cards/` å†…ã®ã‚«ãƒ¼ãƒ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®çµ±åˆæ¤œè¨
- [ ] `forms/` å†…ã®ãƒ•ã‚©ãƒ¼ãƒ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å…±é€šåŒ–

#### 3. å‹å®šç¾©ã®æ•´ç†

**å•é¡Œç‚¹:**
- å‹å®šç¾©ãŒåˆ†æ•£ã—ã¦ã„ã‚‹å¯èƒ½æ€§

**ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:**
- [ ] å…¨ã¦ã®å‹ã‚’ `types/` ã«é›†ç´„
- [ ] æ©Ÿèƒ½åˆ¥ã«å‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ•´ç†
- [ ] Prismaå‹ã¨ã®æ•´åˆæ€§ç¢ºèª

### ğŸŸ¡ ä¸­å„ªå…ˆåº¦ (Phase 2)

#### 4. Features ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ´»ç”¨

ç¾åœ¨ã® `features/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ç¢ºèªã—ã€æ©Ÿèƒ½ãƒ™ãƒ¼ã‚¹ã®æ§‹æˆã‚’å¼·åŒ–ï¼š

```
features/
â”œâ”€â”€ auth/
â”‚   â”œâ”€â”€ components/           # èªè¨¼å°‚ç”¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”‚   â””â”€â”€ useLogout.ts
â”‚   â”œâ”€â”€ schemas/              # èªè¨¼ç”¨Zodã‚¹ã‚­ãƒ¼ãƒ
â”‚   â”œâ”€â”€ types/
â”‚   â””â”€â”€ utils/
â”œâ”€â”€ property-search/
â”‚   â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ schemas/
â”‚   â””â”€â”€ types/
â””â”€â”€ favorites/
    â”œâ”€â”€ components/
    â”œâ”€â”€ hooks/
    â””â”€â”€ types/
```

#### 5. ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã®æ•´ç†

**ãƒã‚§ãƒƒã‚¯é …ç›®:**
- [ ] `hooks/` å†…ã®ãƒ•ãƒƒã‚¯ãŒé©åˆ‡ã«åˆ†é¡ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- [ ] æ©Ÿèƒ½å›ºæœ‰ã®ãƒ•ãƒƒã‚¯ã¯ `features/[name]/hooks/` ã«ç§»å‹•
- [ ] æ±ç”¨ãƒ•ãƒƒã‚¯ã®ã¿ `hooks/` ã«æ®‹ã™

#### 6. ã‚¹ã‚­ãƒ¼ãƒã®æ•´ç†

**ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:**
- [ ] `schemas/` ãŒ `features/` å†…ã®ã‚¹ã‚­ãƒ¼ãƒã¨é‡è¤‡ã—ã¦ã„ãªã„ã‹ç¢ºèª
- [ ] å…±é€šã‚¹ã‚­ãƒ¼ãƒã¨æ©Ÿèƒ½å›ºæœ‰ã‚¹ã‚­ãƒ¼ãƒã‚’æ˜ç¢ºã«åˆ†é›¢

### ğŸŸ¢ ä½å„ªå…ˆåº¦ (Phase 3)

#### 7. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

**ãƒã‚§ãƒƒã‚¯é …ç›®:**
- [ ] ä¸è¦ãªå†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®ç‰¹å®š (React DevTools Profiler)
- [ ] é‡ã„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¸ã® `React.memo` é©ç”¨
- [ ] å‹•çš„ã‚¤ãƒ³ãƒãƒ¼ãƒˆã®æ´»ç”¨ (`next/dynamic`)
- [ ] ç”»åƒæœ€é©åŒ– (`next/image`)

#### 8. å…±æœ‰ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¸ã®æŠ½å‡º

`packages/ui` ã¸ã®æŠ½å‡ºå€™è£œ:
- [ ] `components/ui/` ã®åŸºæœ¬ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- [ ] æ±ç”¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
- [ ] å…±é€šå‹å®šç¾©

## ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæœ€é©åŒ–ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ç¢ºèªã™ã‚‹ã“ã¨

```typescript
// ãƒã‚§ãƒƒã‚¯é …ç›®

// 1. Props ã®å‹å®šç¾©
interface ComponentProps {
  // âœ… å¿…é ˆ vs ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ãŒæ˜ç¢º
  title: string;           // å¿…é ˆ
  subtitle?: string;       // ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«
  
  // âœ… ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®å‘½åè¦å‰‡
  onClick?: () => void;    // on + å‹•è©
  onSubmit?: (data: FormData) => void;
}

// 2. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®šç¾©
export const Component = ({ title, subtitle, onClick }: ComponentProps) => {
  // âœ… æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³
  if (!title) return null;
  
  // âœ… ãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹ã¯æœ€å°é™
  const [isOpen, setIsOpen] = useState(false);
  
  // âœ… ãƒ¡ãƒ¢åŒ–ãŒå¿…è¦ãªè¨ˆç®—
  const expensiveValue = useMemo(() => {
    return computeExpensiveValue(title);
  }, [title]);
  
  // âœ… ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®ãƒ¡ãƒ¢åŒ–
  const handleClick = useCallback(() => {
    onClick?.();
  }, [onClick]);
  
  return (
    // âœ… ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯HTML
    <article className="...">
      <h2>{title}</h2>
      {subtitle && <p>{subtitle}</p>}
    </article>
  );
};

// 3. åå‰ä»˜ãã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
export { Component };
export type { ComponentProps };
```

### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚µã‚¤ã‚ºã®ç›®å®‰

| ã‚µã‚¤ã‚º | è¡Œæ•° | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ |
|--------|------|-----------|
| å° | ~50è¡Œ | âœ… é©åˆ‡ |
| ä¸­ | 50-100è¡Œ | âš ï¸ åˆ†å‰²ã‚’æ¤œè¨ |
| å¤§ | 100è¡Œ+ | ğŸ”´ åˆ†å‰²å¿…é ˆ |

## ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å®Ÿæ–½æ‰‹é †

### 1. æº–å‚™

```bash
# ç¾åœ¨ã®çŠ¶æ…‹ã§ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
pnpm --filter web test

# å‹ãƒã‚§ãƒƒã‚¯
pnpm --filter web type-check

# Lint
pnpm --filter web lint
```

### 2. ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å®Ÿæ–½

1. **å°ã•ãªå¤‰æ›´ã‚’ç©ã¿é‡ã­ã‚‹** - ä¸€åº¦ã«å¤§ããªå¤‰æ›´ã‚’ã—ãªã„
2. **å„å¤‰æ›´å¾Œã«ãƒ†ã‚¹ãƒˆ** - ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ã‚’é˜²ã
3. **ã‚³ãƒŸãƒƒãƒˆã‚’ç´°ã‹ã** - ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å¯èƒ½ã«

### 3. æ¤œè¨¼

```bash
# å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
pnpm --filter web test:run

# å‹ãƒã‚§ãƒƒã‚¯
pnpm --filter web type-check

# ãƒ“ãƒ«ãƒ‰ç¢ºèª
pnpm --filter web build
```

## å…·ä½“çš„ãªãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã‚¿ã‚¹ã‚¯

### ã‚¿ã‚¹ã‚¯1: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆç›´ä¸‹ãƒ•ã‚¡ã‚¤ãƒ«ã®ç§»å‹•

```bash
# 1. æ–°ã—ã„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã‚’ä½œæˆ
mkdir -p apps/web/src/components/property
mkdir -p apps/web/src/components/shared

# 2. ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç§»å‹•
# (æ‰‹å‹•ã§ç¢ºèªã—ãªãŒã‚‰å®Ÿæ–½)

# 3. ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹ã‚’æ›´æ–°
# (IDE ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ©Ÿèƒ½ã‚’æ´»ç”¨)
```

### ã‚¿ã‚¹ã‚¯2: é‡è¤‡ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®çµ±åˆ

```typescript
// çµ±åˆå‰
// PropertySearchDropdown.tsx ã¨ RentalSearchDropdown.tsx

// çµ±åˆå¾Œ
// SearchDropdown.tsx
interface SearchDropdownProps {
  type: 'property' | 'rental';
  // å…±é€šProps
}

export const SearchDropdown = ({ type, ...props }: SearchDropdownProps) => {
  // å…±é€šãƒ­ã‚¸ãƒƒã‚¯
  const config = type === 'property' ? propertyConfig : rentalConfig;
  
  return (
    // å…±é€šUI
  );
};
```

### ã‚¿ã‚¹ã‚¯3: Features æ§‹æˆã¸ã®ç§»è¡Œ

```
# ç§»è¡Œå¯¾è±¡ã®ç‰¹å®š
1. æ¤œç´¢æ©Ÿèƒ½ â†’ features/search/
2. ãŠæ°—ã«å…¥ã‚Šæ©Ÿèƒ½ â†’ features/favorites/
3. èªè¨¼æ©Ÿèƒ½ â†’ features/auth/
4. ç‰©ä»¶è¡¨ç¤ºæ©Ÿèƒ½ â†’ features/property/
```

## æ³¨æ„äº‹é …

- **æ®µéšçš„ã«å®Ÿæ–½**: ä¸€åº¦ã«ã™ã¹ã¦ã‚’å¤‰æ›´ã—ãªã„
- **ãƒ†ã‚¹ãƒˆã‚’å„ªå…ˆ**: ãƒ†ã‚¹ãƒˆãŒãªã„éƒ¨åˆ†ã¯å…ˆã«ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ 
- **å½±éŸ¿ç¯„å›²ã‚’ç¢ºèª**: å¤‰æ›´å‰ã«grepã§ä½¿ç”¨ç®‡æ‰€ã‚’ç¢ºèª
- **ãƒšã‚¢ãƒ¬ãƒ“ãƒ¥ãƒ¼**: å¤§ããªå¤‰æ›´ã¯ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å—ã‘ã‚‹
